set.current(processors=8)
make.file(inputdir=., type=fastq, prefix=nemabiome)
make.contigs(file=nemabiome.files)
summary.seqs(fasta=nemabiome.trim.contigs.fasta, count=nemabiome.contigs.count_table) 
screen.seqs(fasta=nemabiome.trim.contigs.fasta, count=nemabiome.contigs.count_table, minlength=200, maxlength=450, maxambig=0, maxhomop=8)
unique.seqs(fasta=nemabiome.trim.contigs.good.fasta, count=nemabiome.contigs.good.count_table)
align.seqs(candidate=nemabiome.trim.contigs.good.unique.fasta, template=nematode_ITS2_database_version1_3.fasta)
summary.seqs(fasta=nemabiome.trim.contigs.good.unique.align, count=nemabiome.trim.contigs.good.count_table)
screen.seqs(fasta=nemabiome.trim.contigs.good.unique.align, alignreport=nemabiome.trim.contigs.good.unique.align_report, minsim=90, minscore=10)
classify.seqs(fasta=nemabiome.trim.contigs.good.unique.good.align, template=nematode_ITS2_database_version1_3.fasta, taxonomy=nematode_taxonomy_1_3.tax, method=knn, numwanted=3)
summary.tax(taxonomy=nemabiome.trim.contigs.good.unique.good.nematode_taxonomy_1_3.knn.taxonomy, count=nemabiome.trim.contigs.good.count_table)
split.groups(fasta=nemabiome.trim.contigs.good.fasta, count=nemabiome.trim.contigs.good.count_table)
system(mv nemabiome.trim.contigs.good.unique.good.nematode_taxonomy_1_3.knn.tax.summary)
